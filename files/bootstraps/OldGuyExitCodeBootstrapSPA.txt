@@ title = "Certificate Exit Code Bootstrap (SPA)"
@@ author = "Desco + E-Sh4rk"
@@ exit = "Bootstrapped"
@@

; /!\ For now, this code is only available for console or accurate emulators (mGBA >= 0.9)

; This code can be used to create a special exit code bootstrap that stores
; the address of SetupBard instead of Special_ShowDiploma, meaning that this
; bootstrap can be used inside battles, which is required by codes such as
; "Catch Trainer Pokemon".
; Before using this code, you should use the code "Create Pokemon from nothing"
; in order to generate a pokemon of species 0xFF.
; Directly after, you should execute this code without changing the name of Box 14.
; The resulting pokemon willbe in Box 10 Slot 19.
; You should then move this pokemon somewhere in box 14 (but not in the last slot),
; as well as moving the Certificate Exit Code Bootstrap (if you have one) out of it.
; Now, you will be able to use the exit code Bootstrapped.
; Note that you shouldn't change the name of Box 14, if you do you will have
; to run a code with the exit code CertificateFullSPA
; (or the "Restore 'BX r0' in box 14 name" code) in order to reset it
; before being able to use the exit code Bootstrapped again.
; Finally, please note that you cannot use the exit code Bootstrapped
; if the code you are trying to execute modify the value of r0.
; In this case, you have to use the exit code CertificateShortSPA instead.


; === WRITE POKEMON NAME 0-3 ===
sbc r11, r15, #0x2940            ; r11 = &Box10Slot19 + 9
mov r12, #0xE59F0002 ?          ; E59F0002  LDR r0, [r15, #2]
str r12, [r11]!                  ; Write on characters 0-3 of the pokemon name

; === WRITE POKEMON NAME 4-7 ===
adc r11, r11, 0x3                ; r11 = &Box10Slot19 + 12
mov r12, #0xE28FF044 ?          ; E28FF044  ADD pc, pc, #0x44
str r12, [r11]!                  ; Write on characters 4-7 of the pokemon name

; === WRITE POKEMON ORIGINAL TRAINER NAME ===
adc r11, r11, 0xB                ; r11 = &Box10Slot19 + 23
movs r12, 0x811FC03 ?            ; 0x811FCB9 = SetupBard for SPA
adc r0, r12, 0xB6                ; Simplify last addition
str r0, [r11]!                   ; Write on the original trainer name